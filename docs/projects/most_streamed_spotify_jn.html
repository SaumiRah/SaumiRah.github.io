<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Most Streamed Spotify Songs: Data Cleaning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-4d96db332f33ef296d8e0919d4f30bf1.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../cv.pdf"> <i class="bi bi-file-pdf" role="img">
</i> 
<span class="menu-text">CV</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/saumi-rahnamay/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Most Streamed Spotify Songs: Data Cleaning</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Python</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<hr>
<p>This is a practice project for my <a href="https://github.com/SaumiRah/Data-Analytics-Portfolio">Data Analysis Portfolio</a>. I used <a href="https://www.kaggle.com/datasets/nelgiriyewithana/most-streamed-spotify-songs-2024">this data set</a> from Kaggle.</p>
<div id="cell-4" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="data-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning">Data Cleaning</h2>
<ol type="1">
<li>Correct encoding</li>
<li>Data Types</li>
<li>Missing values</li>
<li>Duplicates</li>
<li>Outliers</li>
<li>Formating Data (Date)</li>
</ol>
<section id="correct-encoding" class="level3">
<h3 class="anchored" data-anchor-id="correct-encoding">1. Correct encoding</h3>
<div id="cell-7" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>sdf <span class="op">=</span> pd.read_csv(<span class="st">"Most Streamed Spotify Songs 2024.csv"</span>, encoding<span class="op">=</span><span class="st">'ISO-8859-1'</span>) <span class="co"># not encoded in utf-8</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>sdf.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 4600 entries, 0 to 4599
Data columns (total 29 columns):
 #   Column                      Non-Null Count  Dtype  
---  ------                      --------------  -----  
 0   Track                       4600 non-null   object 
 1   Album Name                  4600 non-null   object 
 2   Artist                      4595 non-null   object 
 3   Release Date                4600 non-null   object 
 4   ISRC                        4600 non-null   object 
 5   All Time Rank               4600 non-null   object 
 6   Track Score                 4600 non-null   float64
 7   Spotify Streams             4487 non-null   object 
 8   Spotify Playlist Count      4530 non-null   object 
 9   Spotify Playlist Reach      4528 non-null   object 
 10  Spotify Popularity          3796 non-null   float64
 11  YouTube Views               4292 non-null   object 
 12  YouTube Likes               4285 non-null   object 
 13  TikTok Posts                3427 non-null   object 
 14  TikTok Likes                3620 non-null   object 
 15  TikTok Views                3619 non-null   object 
 16  YouTube Playlist Reach      3591 non-null   object 
 17  Apple Music Playlist Count  4039 non-null   float64
 18  AirPlay Spins               4102 non-null   object 
 19  SiriusXM Spins              2477 non-null   object 
 20  Deezer Playlist Count       3679 non-null   float64
 21  Deezer Playlist Reach       3672 non-null   object 
 22  Amazon Playlist Count       3545 non-null   float64
 23  Pandora Streams             3494 non-null   object 
 24  Pandora Track Stations      3332 non-null   object 
 25  Soundcloud Streams          1267 non-null   object 
 26  Shazam Counts               4023 non-null   object 
 27  TIDAL Popularity            0 non-null      float64
 28  Explicit Track              4600 non-null   int64  
dtypes: float64(6), int64(1), object(22)
memory usage: 1.0+ MB</code></pre>
</div>
</div>
</section>
<section id="data-types" class="level3">
<h3 class="anchored" data-anchor-id="data-types">2. Data Types</h3>
<p>Most numerical variables were erroneously encoded as strings. Correcting this here.</p>
<div id="cell-10" class="cell" data-execution_count="363">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting all numerical variables erroneously encoded as a string object.</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>objCol <span class="op">=</span> sdf.select_dtypes(include<span class="op">=</span>[<span class="bu">object</span>]).drop([<span class="st">'Track'</span>,<span class="st">'Album Name'</span>,<span class="st">'Artist'</span>,<span class="st">'Release Date'</span>,<span class="st">'ISRC'</span>], axis<span class="op">=</span><span class="dv">1</span>).columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-11" class="cell" data-execution_count="364">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_int(value, default<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Use regex to remove non-numeric characters</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        cleaned_value <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="pp">[^</span><span class="dv">\d</span><span class="pp">]</span><span class="vs">'</span>, <span class="st">''</span>, <span class="bu">str</span>(value))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="bu">int</span>(cleaned_value)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> (<span class="pp">ValueError</span>, <span class="pp">TypeError</span>):</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> default</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>sdf[objCol] <span class="op">=</span> sdf[objCol].<span class="bu">map</span>(convert_to_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-12" class="cell" data-execution_count="365">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sdf.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 4600 entries, 0 to 4599
Data columns (total 29 columns):
 #   Column                      Non-Null Count  Dtype  
---  ------                      --------------  -----  
 0   Track                       4600 non-null   object 
 1   Album Name                  4600 non-null   object 
 2   Artist                      4595 non-null   object 
 3   Release Date                4600 non-null   object 
 4   ISRC                        4600 non-null   object 
 5   All Time Rank               4600 non-null   int64  
 6   Track Score                 4600 non-null   float64
 7   Spotify Streams             4487 non-null   float64
 8   Spotify Playlist Count      4530 non-null   float64
 9   Spotify Playlist Reach      4528 non-null   float64
 10  Spotify Popularity          3796 non-null   float64
 11  YouTube Views               4292 non-null   float64
 12  YouTube Likes               4285 non-null   float64
 13  TikTok Posts                3427 non-null   float64
 14  TikTok Likes                3620 non-null   float64
 15  TikTok Views                3619 non-null   float64
 16  YouTube Playlist Reach      3591 non-null   float64
 17  Apple Music Playlist Count  4039 non-null   float64
 18  AirPlay Spins               4102 non-null   float64
 19  SiriusXM Spins              2477 non-null   float64
 20  Deezer Playlist Count       3679 non-null   float64
 21  Deezer Playlist Reach       3672 non-null   float64
 22  Amazon Playlist Count       3545 non-null   float64
 23  Pandora Streams             3494 non-null   float64
 24  Pandora Track Stations      3332 non-null   float64
 25  Soundcloud Streams          1267 non-null   float64
 26  Shazam Counts               4023 non-null   float64
 27  TIDAL Popularity            0 non-null      float64
 28  Explicit Track              4600 non-null   int64  
dtypes: float64(22), int64(2), object(5)
memory usage: 1.0+ MB</code></pre>
</div>
</div>
</section>
<section id="missing-values" class="level3">
<h3 class="anchored" data-anchor-id="missing-values">3. Missing Values</h3>
<ol type="1">
<li>Get a list of the count of missing values in each column, and drop the ones with too many.</li>
<li>Impute missing numerical values with mean</li>
</ol>
<div id="cell-15" class="cell" data-execution_count="366">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sdfNAs <span class="op">=</span>  pd.DataFrame(sdf.isnull().<span class="bu">sum</span>()).reset_index().rename(columns<span class="op">=</span>{<span class="st">'index'</span>:<span class="st">'Track'</span>, <span class="dv">0</span> :<span class="st">'Missing Values'</span>})</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>sdfNAs[sdfNAs[<span class="st">'Missing Values'</span>]<span class="op">&gt;</span><span class="dv">0</span>].sort_values(by<span class="op">=</span><span class="st">'Missing Values'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="366">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Track</th>
<th data-quarto-table-cell-role="th">Missing Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">27</td>
<td>TIDAL Popularity</td>
<td>4600</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>Soundcloud Streams</td>
<td>3333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>SiriusXM Spins</td>
<td>2123</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>Pandora Track Stations</td>
<td>1268</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>TikTok Posts</td>
<td>1173</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>Pandora Streams</td>
<td>1106</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>Amazon Playlist Count</td>
<td>1055</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>YouTube Playlist Reach</td>
<td>1009</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>TikTok Views</td>
<td>981</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>TikTok Likes</td>
<td>980</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>Deezer Playlist Reach</td>
<td>928</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>Deezer Playlist Count</td>
<td>921</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>Spotify Popularity</td>
<td>804</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26</td>
<td>Shazam Counts</td>
<td>577</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>Apple Music Playlist Count</td>
<td>561</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>AirPlay Spins</td>
<td>498</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>YouTube Likes</td>
<td>315</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>YouTube Views</td>
<td>308</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>Spotify Streams</td>
<td>113</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Spotify Playlist Reach</td>
<td>72</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Spotify Playlist Count</td>
<td>70</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>Artist</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Choosing to drop “TIDAL Popularity”, “Soundcloud Streams”, “SiriusXM Spins” because they are: 1. missing too many values, and; 2. not incredibly interesting.</p>
<div id="cell-17" class="cell" data-execution_count="367">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>sdf.drop([<span class="st">"TIDAL Popularity"</span>, <span class="st">"Soundcloud Streams"</span>, <span class="st">"SiriusXM Spins"</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>sdf.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="367">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Track</th>
<th data-quarto-table-cell-role="th">Album Name</th>
<th data-quarto-table-cell-role="th">Artist</th>
<th data-quarto-table-cell-role="th">Release Date</th>
<th data-quarto-table-cell-role="th">ISRC</th>
<th data-quarto-table-cell-role="th">All Time Rank</th>
<th data-quarto-table-cell-role="th">Track Score</th>
<th data-quarto-table-cell-role="th">Spotify Streams</th>
<th data-quarto-table-cell-role="th">Spotify Playlist Count</th>
<th data-quarto-table-cell-role="th">Spotify Playlist Reach</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">YouTube Playlist Reach</th>
<th data-quarto-table-cell-role="th">Apple Music Playlist Count</th>
<th data-quarto-table-cell-role="th">AirPlay Spins</th>
<th data-quarto-table-cell-role="th">Deezer Playlist Count</th>
<th data-quarto-table-cell-role="th">Deezer Playlist Reach</th>
<th data-quarto-table-cell-role="th">Amazon Playlist Count</th>
<th data-quarto-table-cell-role="th">Pandora Streams</th>
<th data-quarto-table-cell-role="th">Pandora Track Stations</th>
<th data-quarto-table-cell-role="th">Shazam Counts</th>
<th data-quarto-table-cell-role="th">Explicit Track</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MILLION DOLLAR BABY</td>
<td>Million Dollar Baby - Single</td>
<td>Tommy Richman</td>
<td>4/26/2024</td>
<td>QM24S2402528</td>
<td>1</td>
<td>725.4</td>
<td>3.904709e+08</td>
<td>30716.0</td>
<td>196631588.0</td>
<td>...</td>
<td>1.505970e+08</td>
<td>210.0</td>
<td>40975.0</td>
<td>62.0</td>
<td>17598718.0</td>
<td>114.0</td>
<td>18004655.0</td>
<td>22931.0</td>
<td>2669262.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Not Like Us</td>
<td>Not Like Us</td>
<td>Kendrick Lamar</td>
<td>5/4/2024</td>
<td>USUG12400910</td>
<td>2</td>
<td>545.9</td>
<td>3.237039e+08</td>
<td>28113.0</td>
<td>174597137.0</td>
<td>...</td>
<td>1.563804e+08</td>
<td>188.0</td>
<td>40778.0</td>
<td>67.0</td>
<td>10422430.0</td>
<td>111.0</td>
<td>7780028.0</td>
<td>28444.0</td>
<td>1118279.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>i like the way you kiss me</td>
<td>I like the way you kiss me</td>
<td>Artemas</td>
<td>3/19/2024</td>
<td>QZJ842400387</td>
<td>3</td>
<td>538.4</td>
<td>6.013093e+08</td>
<td>54331.0</td>
<td>211607669.0</td>
<td>...</td>
<td>3.737850e+08</td>
<td>190.0</td>
<td>74333.0</td>
<td>136.0</td>
<td>36321847.0</td>
<td>172.0</td>
<td>5022621.0</td>
<td>5639.0</td>
<td>5285340.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Flowers</td>
<td>Flowers - Single</td>
<td>Miley Cyrus</td>
<td>1/12/2023</td>
<td>USSM12209777</td>
<td>4</td>
<td>444.9</td>
<td>2.031281e+09</td>
<td>269802.0</td>
<td>136569078.0</td>
<td>...</td>
<td>3.351189e+09</td>
<td>394.0</td>
<td>1474799.0</td>
<td>264.0</td>
<td>24684248.0</td>
<td>210.0</td>
<td>190260277.0</td>
<td>203384.0</td>
<td>11822942.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Houdini</td>
<td>Houdini</td>
<td>Eminem</td>
<td>5/31/2024</td>
<td>USUG12403398</td>
<td>5</td>
<td>423.3</td>
<td>1.070349e+08</td>
<td>7223.0</td>
<td>151469874.0</td>
<td>...</td>
<td>1.127639e+08</td>
<td>182.0</td>
<td>12185.0</td>
<td>82.0</td>
<td>17660624.0</td>
<td>105.0</td>
<td>4493884.0</td>
<td>7006.0</td>
<td>457017.0</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>5 rows × 26 columns</p>
</div>
</div>
</div>
<p>Imputing missing numerical values by mean.</p>
<div id="cell-19" class="cell" data-execution_count="370">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>intCol <span class="op">=</span> sdf.select_dtypes(include<span class="op">=</span>[np.number]).columns</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>sdf[intCol] <span class="op">=</span> sdf[intCol].fillna(sdf[intCol].mean())</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>intCol</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="370">
<pre><code>Index(['All Time Rank', 'Track Score', 'Spotify Streams',
       'Spotify Playlist Count', 'Spotify Playlist Reach',
       'Spotify Popularity', 'YouTube Views', 'YouTube Likes', 'TikTok Posts',
       'TikTok Likes', 'TikTok Views', 'YouTube Playlist Reach',
       'Apple Music Playlist Count', 'AirPlay Spins', 'Deezer Playlist Count',
       'Deezer Playlist Reach', 'Amazon Playlist Count', 'Pandora Streams',
       'Pandora Track Stations', 'Shazam Counts', 'Explicit Track'],
      dtype='object')</code></pre>
</div>
</div>
<div id="cell-20" class="cell" data-execution_count="371">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sdfNAs <span class="op">=</span>  pd.DataFrame(sdf.isnull().<span class="bu">sum</span>()).reset_index().rename(columns<span class="op">=</span>{<span class="st">'index'</span>:<span class="st">'Track'</span>, <span class="dv">0</span> :<span class="st">'Missing Values'</span>})</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>sdfNAs[sdfNAs[<span class="st">'Missing Values'</span>]<span class="op">&gt;</span><span class="dv">0</span>].sort_values(by<span class="op">=</span><span class="st">'Missing Values'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="371">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Track</th>
<th data-quarto-table-cell-role="th">Missing Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Artist</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="duplicates" class="level3">
<h3 class="anchored" data-anchor-id="duplicates">4. Duplicates</h3>
<div id="cell-22" class="cell" data-execution_count="372">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sdfDupes <span class="op">=</span> pd.DataFrame(sdf.duplicated()).rename(columns<span class="op">=</span>{<span class="dv">0</span>:<span class="st">'duplicate'</span>})</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>sdfDupes[sdfDupes[<span class="st">'duplicate'</span>]<span class="op">==</span> <span class="va">True</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="372">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">duplicate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2450</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3450</td>
<td>True</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-23" class="cell" data-execution_count="373">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sdf.iloc[<span class="dv">2449</span>:<span class="dv">2451</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="373">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Track</th>
<th data-quarto-table-cell-role="th">Album Name</th>
<th data-quarto-table-cell-role="th">Artist</th>
<th data-quarto-table-cell-role="th">Release Date</th>
<th data-quarto-table-cell-role="th">ISRC</th>
<th data-quarto-table-cell-role="th">All Time Rank</th>
<th data-quarto-table-cell-role="th">Track Score</th>
<th data-quarto-table-cell-role="th">Spotify Streams</th>
<th data-quarto-table-cell-role="th">Spotify Playlist Count</th>
<th data-quarto-table-cell-role="th">Spotify Playlist Reach</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">YouTube Playlist Reach</th>
<th data-quarto-table-cell-role="th">Apple Music Playlist Count</th>
<th data-quarto-table-cell-role="th">AirPlay Spins</th>
<th data-quarto-table-cell-role="th">Deezer Playlist Count</th>
<th data-quarto-table-cell-role="th">Deezer Playlist Reach</th>
<th data-quarto-table-cell-role="th">Amazon Playlist Count</th>
<th data-quarto-table-cell-role="th">Pandora Streams</th>
<th data-quarto-table-cell-role="th">Pandora Track Stations</th>
<th data-quarto-table-cell-role="th">Shazam Counts</th>
<th data-quarto-table-cell-role="th">Explicit Track</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2449</td>
<td>Tennessee Orange</td>
<td>Tennessee Orange</td>
<td>Megan Moroney</td>
<td>9/2/2022</td>
<td>TCAGJ2289254</td>
<td>2424</td>
<td>28.9</td>
<td>227893586.0</td>
<td>28139.0</td>
<td>12480714.0</td>
<td>...</td>
<td>238206228.0</td>
<td>33.0</td>
<td>129172.0</td>
<td>5.0</td>
<td>1370.0</td>
<td>49.0</td>
<td>56972562.0</td>
<td>26968.0</td>
<td>708143.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2450</td>
<td>Tennessee Orange</td>
<td>Tennessee Orange</td>
<td>Megan Moroney</td>
<td>9/2/2022</td>
<td>TCAGJ2289254</td>
<td>2424</td>
<td>28.9</td>
<td>227893586.0</td>
<td>28139.0</td>
<td>12480714.0</td>
<td>...</td>
<td>238206228.0</td>
<td>33.0</td>
<td>129172.0</td>
<td>5.0</td>
<td>1370.0</td>
<td>49.0</td>
<td>56972562.0</td>
<td>26968.0</td>
<td>708143.0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>2 rows × 26 columns</p>
</div>
</div>
</div>
<div id="cell-24" class="cell" data-execution_count="374">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>sdf <span class="op">=</span> sdf.drop(sdf.index[<span class="dv">2449</span>], axis<span class="op">=</span><span class="dv">0</span>).reset_index()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>sdf.iloc[<span class="dv">2448</span>:<span class="dv">2452</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="374">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">Track</th>
<th data-quarto-table-cell-role="th">Album Name</th>
<th data-quarto-table-cell-role="th">Artist</th>
<th data-quarto-table-cell-role="th">Release Date</th>
<th data-quarto-table-cell-role="th">ISRC</th>
<th data-quarto-table-cell-role="th">All Time Rank</th>
<th data-quarto-table-cell-role="th">Track Score</th>
<th data-quarto-table-cell-role="th">Spotify Streams</th>
<th data-quarto-table-cell-role="th">Spotify Playlist Count</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">YouTube Playlist Reach</th>
<th data-quarto-table-cell-role="th">Apple Music Playlist Count</th>
<th data-quarto-table-cell-role="th">AirPlay Spins</th>
<th data-quarto-table-cell-role="th">Deezer Playlist Count</th>
<th data-quarto-table-cell-role="th">Deezer Playlist Reach</th>
<th data-quarto-table-cell-role="th">Amazon Playlist Count</th>
<th data-quarto-table-cell-role="th">Pandora Streams</th>
<th data-quarto-table-cell-role="th">Pandora Track Stations</th>
<th data-quarto-table-cell-role="th">Shazam Counts</th>
<th data-quarto-table-cell-role="th">Explicit Track</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2448</td>
<td>2448</td>
<td>Am I Wrong</td>
<td>More Music 2013</td>
<td>Nico &amp; Vinz</td>
<td>1/1/2013</td>
<td>USWB11304681</td>
<td>2440</td>
<td>28.9</td>
<td>965827790.0</td>
<td>160031.0</td>
<td>...</td>
<td>2936860.0</td>
<td>89.0</td>
<td>31268.0</td>
<td>64.0</td>
<td>111728.0</td>
<td>13.0</td>
<td>598857243.0</td>
<td>319806.0</td>
<td>19231875.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2449</td>
<td>2450</td>
<td>Tennessee Orange</td>
<td>Tennessee Orange</td>
<td>Megan Moroney</td>
<td>9/2/2022</td>
<td>TCAGJ2289254</td>
<td>2424</td>
<td>28.9</td>
<td>227893586.0</td>
<td>28139.0</td>
<td>...</td>
<td>238206228.0</td>
<td>33.0</td>
<td>129172.0</td>
<td>5.0</td>
<td>1370.0</td>
<td>49.0</td>
<td>56972562.0</td>
<td>26968.0</td>
<td>708143.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2450</td>
<td>2451</td>
<td>Still Trappin' (with King Von)</td>
<td>The Voice</td>
<td>Lil Durk</td>
<td>12/24/2020</td>
<td>USUM72024651</td>
<td>2448</td>
<td>28.8</td>
<td>176140377.0</td>
<td>76081.0</td>
<td>...</td>
<td>35450506.0</td>
<td>36.0</td>
<td>10226.0</td>
<td>7.0</td>
<td>31768.0</td>
<td>13.0</td>
<td>27955730.0</td>
<td>8002.0</td>
<td>494233.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2451</td>
<td>2452</td>
<td>De Fresa y Coco</td>
<td>De Fresa y Coco</td>
<td>Luis R Conriquez</td>
<td>11/10/2023</td>
<td>QMANG2226771</td>
<td>2445</td>
<td>28.8</td>
<td>81186913.0</td>
<td>7818.0</td>
<td>...</td>
<td>242836946.0</td>
<td>3.0</td>
<td>3.0</td>
<td>1.0</td>
<td>2878.0</td>
<td>1.0</td>
<td>340543.0</td>
<td>2169.0</td>
<td>147308.0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>4 rows × 27 columns</p>
</div>
</div>
</div>
</section>
<section id="outliers-z-scores" class="level3">
<h3 class="anchored" data-anchor-id="outliers-z-scores">5. Outliers: Z-scores</h3>
<div id="cell-26" class="cell" data-execution_count="394">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> zscoring(df, columns, threshold <span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    z_scores_dict <span class="op">=</span> {}</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> columns:</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>        z_scores <span class="op">=</span> np.<span class="bu">abs</span>((df[col] <span class="op">-</span> df[col].mean()) <span class="op">/</span> df[col].std())</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        z_scores_dict[col <span class="op">+</span> <span class="st">'_zscore'</span>] <span class="op">=</span> z_scores</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    z_scores_df <span class="op">=</span> pd.DataFrame(z_scores_dict)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> z_scores_df</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>z_scores_sdf <span class="op">=</span> zscoring(sdf, intCol)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>z_scores_sdf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="394">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">All Time Rank_zscore</th>
<th data-quarto-table-cell-role="th">Track Score_zscore</th>
<th data-quarto-table-cell-role="th">Spotify Streams_zscore</th>
<th data-quarto-table-cell-role="th">Spotify Playlist Count_zscore</th>
<th data-quarto-table-cell-role="th">Spotify Playlist Reach_zscore</th>
<th data-quarto-table-cell-role="th">Spotify Popularity_zscore</th>
<th data-quarto-table-cell-role="th">YouTube Views_zscore</th>
<th data-quarto-table-cell-role="th">YouTube Likes_zscore</th>
<th data-quarto-table-cell-role="th">TikTok Posts_zscore</th>
<th data-quarto-table-cell-role="th">TikTok Likes_zscore</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">YouTube Playlist Reach_zscore</th>
<th data-quarto-table-cell-role="th">Apple Music Playlist Count_zscore</th>
<th data-quarto-table-cell-role="th">AirPlay Spins_zscore</th>
<th data-quarto-table-cell-role="th">Deezer Playlist Count_zscore</th>
<th data-quarto-table-cell-role="th">Deezer Playlist Reach_zscore</th>
<th data-quarto-table-cell-role="th">Amazon Playlist Count_zscore</th>
<th data-quarto-table-cell-role="th">Pandora Streams_zscore</th>
<th data-quarto-table-cell-role="th">Pandora Track Stations_zscore</th>
<th data-quarto-table-cell-role="th">Shazam Counts_zscore</th>
<th data-quarto-table-cell-role="th">Explicit Track_zscore</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.730622</td>
<td>17.732756</td>
<td>0.107108</td>
<td>0.406289</td>
<td>5.882628</td>
<td>1.938203</td>
<td>0.469887</td>
<td>0.274599</td>
<td>2.288098</td>
<td>1.104820</td>
<td>...</td>
<td>0.326421</td>
<td>2.315517</td>
<td>0.117118</td>
<td>0.611515</td>
<td>5.131862</td>
<td>3.885922</td>
<td>0.462468</td>
<td>0.292580</td>
<td>0.024738</td>
<td>0.748277</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.729866</td>
<td>13.076162</td>
<td>0.232649</td>
<td>0.443162</td>
<td>5.134597</td>
<td>1.938203</td>
<td>0.422586</td>
<td>0.125419</td>
<td>0.127990</td>
<td>0.158752</td>
<td>...</td>
<td>0.316659</td>
<td>1.987692</td>
<td>0.118749</td>
<td>0.714522</td>
<td>2.872978</td>
<td>3.754428</td>
<td>0.532345</td>
<td>0.267749</td>
<td>0.249878</td>
<td>1.336112</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1.729111</td>
<td>12.881597</td>
<td>0.289327</td>
<td>0.071771</td>
<td>6.391039</td>
<td>1.938203</td>
<td>0.413365</td>
<td>0.158310</td>
<td>0.987168</td>
<td>0.333133</td>
<td>...</td>
<td>0.050303</td>
<td>2.017495</td>
<td>0.159020</td>
<td>2.136021</td>
<td>11.025354</td>
<td>6.428142</td>
<td>0.551190</td>
<td>0.370464</td>
<td>0.487939</td>
<td>0.748277</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1.728355</td>
<td>10.456017</td>
<td>2.978073</td>
<td>2.980478</td>
<td>3.843613</td>
<td>1.462161</td>
<td>1.022392</td>
<td>1.736456</td>
<td>2.962738</td>
<td>1.980611</td>
<td>...</td>
<td>5.075927</td>
<td>5.057322</td>
<td>11.752106</td>
<td>4.773004</td>
<td>7.362179</td>
<td>8.093734</td>
<td>0.714773</td>
<td>0.520190</td>
<td>1.645482</td>
<td>0.748277</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1.727599</td>
<td>9.895669</td>
<td>0.640047</td>
<td>0.739078</td>
<td>4.349468</td>
<td>1.666179</td>
<td>0.480065</td>
<td>0.166794</td>
<td>0.440283</td>
<td>0.000044</td>
<td>...</td>
<td>0.390280</td>
<td>1.898286</td>
<td>0.355442</td>
<td>1.023543</td>
<td>5.151349</td>
<td>3.491440</td>
<td>0.554804</td>
<td>0.364307</td>
<td>0.366960</td>
<td>1.336112</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4594</td>
<td>1.734176</td>
<td>0.582317</td>
<td>0.267724</td>
<td>0.090268</td>
<td>0.619423</td>
<td>0.510078</td>
<td>0.374063</td>
<td>0.345765</td>
<td>0.425117</td>
<td>0.189547</td>
<td>...</td>
<td>0.580527</td>
<td>0.769014</td>
<td>0.456260</td>
<td>0.624571</td>
<td>0.403222</td>
<td>0.000225</td>
<td>0.448120</td>
<td>0.336481</td>
<td>0.331669</td>
<td>1.336112</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4595</td>
<td>1.726618</td>
<td>0.582317</td>
<td>0.742998</td>
<td>0.776206</td>
<td>0.743446</td>
<td>0.510012</td>
<td>0.797950</td>
<td>0.545153</td>
<td>0.000089</td>
<td>0.230960</td>
<td>...</td>
<td>0.538464</td>
<td>0.798816</td>
<td>0.452899</td>
<td>0.645173</td>
<td>0.407405</td>
<td>0.000225</td>
<td>0.000043</td>
<td>0.000060</td>
<td>0.413602</td>
<td>0.748277</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4596</td>
<td>1.723594</td>
<td>0.582317</td>
<td>0.484101</td>
<td>0.179454</td>
<td>0.565047</td>
<td>0.102042</td>
<td>0.297696</td>
<td>0.417077</td>
<td>0.444460</td>
<td>0.220121</td>
<td>...</td>
<td>0.531240</td>
<td>0.530596</td>
<td>0.454621</td>
<td>0.645173</td>
<td>0.407674</td>
<td>0.847865</td>
<td>0.008521</td>
<td>0.265249</td>
<td>0.246740</td>
<td>1.336112</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4597</td>
<td>1.738711</td>
<td>0.582317</td>
<td>0.567784</td>
<td>0.642555</td>
<td>0.541885</td>
<td>0.170048</td>
<td>1.055567</td>
<td>0.211595</td>
<td>0.442639</td>
<td>0.225767</td>
<td>...</td>
<td>0.538164</td>
<td>0.798816</td>
<td>0.446376</td>
<td>0.000122</td>
<td>0.000089</td>
<td>0.804034</td>
<td>0.538921</td>
<td>0.000060</td>
<td>0.368505</td>
<td>0.748277</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4598</td>
<td>1.740223</td>
<td>0.582317</td>
<td>0.360439</td>
<td>0.386146</td>
<td>0.315129</td>
<td>0.034036</td>
<td>0.683474</td>
<td>0.202123</td>
<td>0.411060</td>
<td>0.210349</td>
<td>...</td>
<td>0.283827</td>
<td>0.649805</td>
<td>0.439067</td>
<td>0.583369</td>
<td>0.367571</td>
<td>0.935528</td>
<td>0.113906</td>
<td>0.344876</td>
<td>0.312074</td>
<td>1.336112</td>
</tr>
</tbody>
</table>

<p>4599 rows × 21 columns</p>
</div>
</div>
</div>
<div id="cell-27" class="cell" data-execution_count="395">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_outliers(df, z_scores_sdf, threshold<span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Identify rows with any Z-score greater than threshold</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    outliers_mask <span class="op">=</span> (z_scores_sdf <span class="op">&gt;</span> threshold).<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove outliers from main DataFrame</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    df_clean <span class="op">=</span> df[<span class="op">~</span>outliers_mask]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_clean</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>sdfClean <span class="op">=</span> remove_outliers(sdf, z_scores_sdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-28" class="cell" data-execution_count="398">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>sdf <span class="op">=</span> sdfClean.reset_index()</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>sdf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="398">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">level_0</th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">Track</th>
<th data-quarto-table-cell-role="th">Album Name</th>
<th data-quarto-table-cell-role="th">Artist</th>
<th data-quarto-table-cell-role="th">Release Date</th>
<th data-quarto-table-cell-role="th">ISRC</th>
<th data-quarto-table-cell-role="th">All Time Rank</th>
<th data-quarto-table-cell-role="th">Track Score</th>
<th data-quarto-table-cell-role="th">Spotify Streams</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">YouTube Playlist Reach</th>
<th data-quarto-table-cell-role="th">Apple Music Playlist Count</th>
<th data-quarto-table-cell-role="th">AirPlay Spins</th>
<th data-quarto-table-cell-role="th">Deezer Playlist Count</th>
<th data-quarto-table-cell-role="th">Deezer Playlist Reach</th>
<th data-quarto-table-cell-role="th">Amazon Playlist Count</th>
<th data-quarto-table-cell-role="th">Pandora Streams</th>
<th data-quarto-table-cell-role="th">Pandora Track Stations</th>
<th data-quarto-table-cell-role="th">Shazam Counts</th>
<th data-quarto-table-cell-role="th">Explicit Track</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>98</td>
<td>98</td>
<td>Agora Hills</td>
<td>Scarlet</td>
<td>Doja Cat</td>
<td>9/22/2023</td>
<td>USRC12301954</td>
<td>99</td>
<td>152.8</td>
<td>509653100.0</td>
<td>...</td>
<td>1.561457e+09</td>
<td>80.0</td>
<td>400206.000000</td>
<td>78.000000</td>
<td>9.341155e+06</td>
<td>39.000000</td>
<td>2.311027e+07</td>
<td>19559.000000</td>
<td>4295361.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>100</td>
<td>100</td>
<td>Montagem Rave Eterno</td>
<td>Montagem Rave Eterno</td>
<td>Dj Samir</td>
<td>5/2/2024</td>
<td>GXD7G2413058</td>
<td>101</td>
<td>152.3</td>
<td>5157486.0</td>
<td>...</td>
<td>3.439601e+08</td>
<td>3.0</td>
<td>55139.156753</td>
<td>2.000000</td>
<td>3.936600e+04</td>
<td>25.348942</td>
<td>8.566735e+07</td>
<td>87876.965786</td>
<td>47658.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>101</td>
<td>101</td>
<td>Lil Boo Thang</td>
<td>Lil Boo Thang</td>
<td>Paul Russell</td>
<td>8/18/2023</td>
<td>USAR12300323</td>
<td>102</td>
<td>152.1</td>
<td>242070373.0</td>
<td>...</td>
<td>1.559373e+07</td>
<td>106.0</td>
<td>370635.000000</td>
<td>69.000000</td>
<td>1.792014e+06</td>
<td>79.000000</td>
<td>8.442572e+07</td>
<td>30713.000000</td>
<td>2219984.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>106</td>
<td>106</td>
<td>Type Shit</td>
<td>WE DON'T TRUST YOU</td>
<td>Future</td>
<td>3/22/2024</td>
<td>USSM12402033</td>
<td>107</td>
<td>148.1</td>
<td>205206688.0</td>
<td>...</td>
<td>2.324409e+08</td>
<td>99.0</td>
<td>3432.000000</td>
<td>41.000000</td>
<td>2.943724e+06</td>
<td>47.000000</td>
<td>5.897303e+06</td>
<td>4527.000000</td>
<td>900933.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>107</td>
<td>107</td>
<td>Armageddon</td>
<td>Armageddon - The 1st Album</td>
<td>aespa</td>
<td>5/27/2024</td>
<td>KRA302400093</td>
<td>108</td>
<td>147.4</td>
<td>32942304.0</td>
<td>...</td>
<td>2.951077e+07</td>
<td>37.0</td>
<td>290.000000</td>
<td>5.000000</td>
<td>5.308310e+05</td>
<td>33.000000</td>
<td>2.186900e+04</td>
<td>48.000000</td>
<td>29736.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3689</td>
<td>4594</td>
<td>4595</td>
<td>For the Last Time</td>
<td>For the Last Time</td>
<td>$uicideboy$</td>
<td>9/5/2017</td>
<td>QM8DG1703420</td>
<td>4585</td>
<td>19.4</td>
<td>305049963.0</td>
<td>...</td>
<td>5.301600e+04</td>
<td>3.0</td>
<td>6.000000</td>
<td>2.000000</td>
<td>1.421700e+04</td>
<td>25.348942</td>
<td>2.010407e+07</td>
<td>13184.000000</td>
<td>656337.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3690</td>
<td>4595</td>
<td>4596</td>
<td>Dil Meri Na Sune</td>
<td>Dil Meri Na Sune (From "Genius")</td>
<td>Atif Aslam</td>
<td>7/27/2018</td>
<td>INT101800122</td>
<td>4575</td>
<td>19.4</td>
<td>52282360.0</td>
<td>...</td>
<td>2.497305e+07</td>
<td>1.0</td>
<td>412.000000</td>
<td>1.000000</td>
<td>9.270000e+02</td>
<td>25.348942</td>
<td>8.566735e+07</td>
<td>87876.965786</td>
<td>193590.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3691</td>
<td>4596</td>
<td>4597</td>
<td>Grace (feat. 42 Dugg)</td>
<td>My Turn</td>
<td>Lil Baby</td>
<td>2/28/2020</td>
<td>USUG12000043</td>
<td>4571</td>
<td>19.4</td>
<td>189972685.0</td>
<td>...</td>
<td>2.925315e+07</td>
<td>19.0</td>
<td>204.000000</td>
<td>1.000000</td>
<td>7.400000e+01</td>
<td>6.000000</td>
<td>8.442674e+07</td>
<td>28999.000000</td>
<td>1135998.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3692</td>
<td>4597</td>
<td>4598</td>
<td>Nashe Si Chadh Gayi</td>
<td>November Top 10 Songs</td>
<td>Arijit Singh</td>
<td>11/8/2016</td>
<td>INY091600067</td>
<td>4591</td>
<td>19.4</td>
<td>145467020.0</td>
<td>...</td>
<td>2.515052e+07</td>
<td>1.0</td>
<td>1200.000000</td>
<td>32.310954</td>
<td>1.294939e+06</td>
<td>7.000000</td>
<td>6.817840e+06</td>
<td>87876.965786</td>
<td>448292.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3693</td>
<td>4598</td>
<td>4599</td>
<td>Me Acostumbre (feat. Bad Bunny)</td>
<td>Me Acostumbre (feat. Bad Bunny)</td>
<td>Arcï¿½ï¿½</td>
<td>4/11/2017</td>
<td>USB271700107</td>
<td>4593</td>
<td>19.4</td>
<td>255740653.0</td>
<td>...</td>
<td>1.758314e+08</td>
<td>11.0</td>
<td>2083.000000</td>
<td>4.000000</td>
<td>1.274790e+05</td>
<td>4.000000</td>
<td>6.900674e+07</td>
<td>11320.000000</td>
<td>767006.0</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>3694 rows × 28 columns</p>
</div>
</div>
</div>
</section>
<section id="formating-date" class="level3">
<h3 class="anchored" data-anchor-id="formating-date">6. Formating Date</h3>
<div id="cell-30" class="cell" data-execution_count="399">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>sdf[<span class="st">'Release Date'</span>] <span class="op">=</span> pd.to_datetime(sdf[<span class="st">'Release Date'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-31" class="cell" data-execution_count="404">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>sdf[<span class="st">'Release Month'</span>] <span class="op">=</span> sdf[<span class="st">'Release Date'</span>].dt.month</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>sdf[<span class="st">'Release Year'</span>] <span class="op">=</span> sdf[<span class="st">'Release Date'</span>].dt.year</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>sdf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="404">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">level_0</th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">Track</th>
<th data-quarto-table-cell-role="th">Album Name</th>
<th data-quarto-table-cell-role="th">Artist</th>
<th data-quarto-table-cell-role="th">Release Date</th>
<th data-quarto-table-cell-role="th">ISRC</th>
<th data-quarto-table-cell-role="th">All Time Rank</th>
<th data-quarto-table-cell-role="th">Track Score</th>
<th data-quarto-table-cell-role="th">Spotify Streams</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">AirPlay Spins</th>
<th data-quarto-table-cell-role="th">Deezer Playlist Count</th>
<th data-quarto-table-cell-role="th">Deezer Playlist Reach</th>
<th data-quarto-table-cell-role="th">Amazon Playlist Count</th>
<th data-quarto-table-cell-role="th">Pandora Streams</th>
<th data-quarto-table-cell-role="th">Pandora Track Stations</th>
<th data-quarto-table-cell-role="th">Shazam Counts</th>
<th data-quarto-table-cell-role="th">Explicit Track</th>
<th data-quarto-table-cell-role="th">Release Month</th>
<th data-quarto-table-cell-role="th">Release Year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>98</td>
<td>98</td>
<td>Agora Hills</td>
<td>Scarlet</td>
<td>Doja Cat</td>
<td>2023-09-22</td>
<td>USRC12301954</td>
<td>99</td>
<td>152.8</td>
<td>509653100.0</td>
<td>...</td>
<td>400206.000000</td>
<td>78.000000</td>
<td>9.341155e+06</td>
<td>39.000000</td>
<td>2.311027e+07</td>
<td>19559.000000</td>
<td>4295361.0</td>
<td>1</td>
<td>9</td>
<td>2023</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>100</td>
<td>100</td>
<td>Montagem Rave Eterno</td>
<td>Montagem Rave Eterno</td>
<td>Dj Samir</td>
<td>2024-05-02</td>
<td>GXD7G2413058</td>
<td>101</td>
<td>152.3</td>
<td>5157486.0</td>
<td>...</td>
<td>55139.156753</td>
<td>2.000000</td>
<td>3.936600e+04</td>
<td>25.348942</td>
<td>8.566735e+07</td>
<td>87876.965786</td>
<td>47658.0</td>
<td>0</td>
<td>5</td>
<td>2024</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>101</td>
<td>101</td>
<td>Lil Boo Thang</td>
<td>Lil Boo Thang</td>
<td>Paul Russell</td>
<td>2023-08-18</td>
<td>USAR12300323</td>
<td>102</td>
<td>152.1</td>
<td>242070373.0</td>
<td>...</td>
<td>370635.000000</td>
<td>69.000000</td>
<td>1.792014e+06</td>
<td>79.000000</td>
<td>8.442572e+07</td>
<td>30713.000000</td>
<td>2219984.0</td>
<td>0</td>
<td>8</td>
<td>2023</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>106</td>
<td>106</td>
<td>Type Shit</td>
<td>WE DON'T TRUST YOU</td>
<td>Future</td>
<td>2024-03-22</td>
<td>USSM12402033</td>
<td>107</td>
<td>148.1</td>
<td>205206688.0</td>
<td>...</td>
<td>3432.000000</td>
<td>41.000000</td>
<td>2.943724e+06</td>
<td>47.000000</td>
<td>5.897303e+06</td>
<td>4527.000000</td>
<td>900933.0</td>
<td>1</td>
<td>3</td>
<td>2024</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>107</td>
<td>107</td>
<td>Armageddon</td>
<td>Armageddon - The 1st Album</td>
<td>aespa</td>
<td>2024-05-27</td>
<td>KRA302400093</td>
<td>108</td>
<td>147.4</td>
<td>32942304.0</td>
<td>...</td>
<td>290.000000</td>
<td>5.000000</td>
<td>5.308310e+05</td>
<td>33.000000</td>
<td>2.186900e+04</td>
<td>48.000000</td>
<td>29736.0</td>
<td>0</td>
<td>5</td>
<td>2024</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3689</td>
<td>4594</td>
<td>4595</td>
<td>For the Last Time</td>
<td>For the Last Time</td>
<td>$uicideboy$</td>
<td>2017-09-05</td>
<td>QM8DG1703420</td>
<td>4585</td>
<td>19.4</td>
<td>305049963.0</td>
<td>...</td>
<td>6.000000</td>
<td>2.000000</td>
<td>1.421700e+04</td>
<td>25.348942</td>
<td>2.010407e+07</td>
<td>13184.000000</td>
<td>656337.0</td>
<td>1</td>
<td>9</td>
<td>2017</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3690</td>
<td>4595</td>
<td>4596</td>
<td>Dil Meri Na Sune</td>
<td>Dil Meri Na Sune (From "Genius")</td>
<td>Atif Aslam</td>
<td>2018-07-27</td>
<td>INT101800122</td>
<td>4575</td>
<td>19.4</td>
<td>52282360.0</td>
<td>...</td>
<td>412.000000</td>
<td>1.000000</td>
<td>9.270000e+02</td>
<td>25.348942</td>
<td>8.566735e+07</td>
<td>87876.965786</td>
<td>193590.0</td>
<td>0</td>
<td>7</td>
<td>2018</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3691</td>
<td>4596</td>
<td>4597</td>
<td>Grace (feat. 42 Dugg)</td>
<td>My Turn</td>
<td>Lil Baby</td>
<td>2020-02-28</td>
<td>USUG12000043</td>
<td>4571</td>
<td>19.4</td>
<td>189972685.0</td>
<td>...</td>
<td>204.000000</td>
<td>1.000000</td>
<td>7.400000e+01</td>
<td>6.000000</td>
<td>8.442674e+07</td>
<td>28999.000000</td>
<td>1135998.0</td>
<td>1</td>
<td>2</td>
<td>2020</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3692</td>
<td>4597</td>
<td>4598</td>
<td>Nashe Si Chadh Gayi</td>
<td>November Top 10 Songs</td>
<td>Arijit Singh</td>
<td>2016-11-08</td>
<td>INY091600067</td>
<td>4591</td>
<td>19.4</td>
<td>145467020.0</td>
<td>...</td>
<td>1200.000000</td>
<td>32.310954</td>
<td>1.294939e+06</td>
<td>7.000000</td>
<td>6.817840e+06</td>
<td>87876.965786</td>
<td>448292.0</td>
<td>0</td>
<td>11</td>
<td>2016</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3693</td>
<td>4598</td>
<td>4599</td>
<td>Me Acostumbre (feat. Bad Bunny)</td>
<td>Me Acostumbre (feat. Bad Bunny)</td>
<td>Arcï¿½ï¿½</td>
<td>2017-04-11</td>
<td>USB271700107</td>
<td>4593</td>
<td>19.4</td>
<td>255740653.0</td>
<td>...</td>
<td>2083.000000</td>
<td>4.000000</td>
<td>1.274790e+05</td>
<td>4.000000</td>
<td>6.900674e+07</td>
<td>11320.000000</td>
<td>767006.0</td>
<td>1</td>
<td>4</td>
<td>2017</td>
</tr>
</tbody>
</table>

<p>3694 rows × 30 columns</p>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>